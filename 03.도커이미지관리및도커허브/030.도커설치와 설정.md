

## 1. 도커 엔진: OS에 설치 (Native Install) - **표준 방식**

도커는 애플리케이션을 격리된 환경(컨테이너)에서 실행하기 위한 **플랫폼**입니다. 따라서 이 플랫폼을 구동하는 '엔진'은 반드시 호스트 OS 위에 직접 설치되어야 합니다.

* **설치 대상:** Windows(Docker Desktop), macOS, Ubuntu 서버 등
* **특징:** 호스트 OS의 커널(Kernel)을 직접 제어하여 컨테이너들에게 자원을 나눠주는 역할을 합니다.
* **장점:** 안정적인 성능, 시스템 자원(CPU/메모리)에 대한 직접적인 제어권 확보.

---

## 2. 도커 이미지로 도커 설치: DinD (Docker-in-Docker) - **특수 방식**

도커 컨테이너 내부에서 또 다른 도커를 실행하는 기술을 **DinD(Docker-in-Docker)**라고 부릅니다. 이는 도커 엔진을 '이미지' 형태로 실행하는 예외적인 케이스입니다.

* **구조:** 도커 컨테이너(부모) 안에서 도커 엔진(자식)이 돌아가는 이중 구조입니다.
* **특징:** `--privileged` 옵션을 통해 호스트 OS의 권한을 강제로 빌려와야 합니다.
* **주요 용도:**
* **CI/CD 환경:** Jenkins 컨테이너 내부에서 빌드 결과물을 도커 이미지로 구워야 할 때.
* **도커 자체 개발:** 도커 엔진 자체를 테스트하거나 개발할 때.


* **단점:** 보안에 취약하고, 저장소(Storage) 계층이 겹쳐 성능 저하 및 예기치 못한 에러가 발생할 확률이 높습니다.

---

## 3. 요약 및 권장 가이드

| 항목 | OS 직접 설치 (추천) | 도커 이미지로 설치 (DinD) |
| --- | --- | --- |
| **적합한 상황** | 일반적인 모든 개발 및 운영 환경 | CI/CD 파이프라인, 특수한 테스트 환경 |
| **성능** | 최적 (Native Performance) | 낮음 (중첩 가상화/오버헤드 발생) |
| **보안** | 표준 보안 정책 적용 | 위험 (호스트의 루트 권한 필요) |
| **관리 난이도** | 쉬움 (표준 업데이트 방식) | 매우 어려움 (복잡한 권한 설정) |

---

강사님의 모든 교재 작성 원칙(명칭 통일, 불필요한 수식어 제거, AWS 과금 안내, 깃허브 포맷, Next Step 표기 등)을 엄격히 준수하여 **도커 설치 및 설정** 강의록을 다시 작성했습니다.

---

## 도커(Docker) 설치 및 실무 환경 설정

본 과정은 가상화 인프라 위에 컨테이너 환경을 구축하기 위한 도커 엔진 설치와 최적화 설정 과정을 다룹니다. 노드 PC(Windows)와 노드 PC 내 가상 머신(Ubuntu) 환경을 모두 포함합니다.

### 1. 도커 아키텍처의 이해

도커는 애플리케이션 실행에 필요한 모든 라이브러리와 종속성을 하나로 묶어 격리된 환경에서 실행하는 플랫폼입니다.

* **도커 엔진(Docker Engine):** 컨테이너를 생성, 관리, 실행하는 핵심 서비스입니다.
* **이미지(Image):** 애플리케이션 실행 환경이 저장된 읽기 전용 템플릿입니다.
* **컨테이너(Container):** 이미지가 메모리 상에서 실행되는 프로세스 단위입니다.
* **레지스트리(Registry):** 도커 이미지를 저장하고 공유하는 저장소(Docker Hub 등)입니다.

---

### 2. 노드 PC 환경별 도커 설치

마스터 서버에서 `tr_iso.pj` 프로젝트를 통해 배포한 리소스를 사용하여 설치를 진행합니다.

#### ① Windows 호스트 (노드 PC)

1. **경로 확인:** `C:\VM_Storage\docker-desktop-installer.exe` 실행
2. **설치 옵션:** 'Use the WSL 2 based engine' 항목 반드시 선택
3. **시스템 요구사항:** WSL 2 Linux 커널 업데이트 패키지(`wsl_update_x64.msi`) 선행 설치 권장

#### ② 가상 머신 (Ubuntu VM)

가상 머신 내부에서는 리눅스 네이티브 도커 엔진을 설치합니다.

```bash
# 필수 패키지 및 GPG 키 등록
sudo apt-get update
sudo apt-get install ca-certificates curl gnupg
sudo install -m 0755 -d /etc/apt/keyrings
curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo gpg --dearmor -o /etc/apt/keyrings/docker.gpg

# 저장소(Repository) 설정
echo "deb [arch=$(dpkg --print-architecture) signed-by=/etc/apt/keyrings/docker.gpg] https://download.docker.com/linux/ubuntu $(. /etc/os-release && echo "$VERSION_CODENAME") stable" | sudo tee /etc/apt/sources.list.d/docker.list > /dev/null

# 도커 엔진 패키지 설치
sudo apt-get update
sudo apt-get install docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin

```

---

### 3. 실무 환경 설정 (Post-Installation)

설치 후 원활한 실습을 위해 사용자 권한과 자동 실행 설정을 수행합니다.

#### 사용자 권한 부여

매번 `sudo` 명령어를 사용하지 않도록 현재 사용자를 `docker` 그룹에 등록합니다.

```bash
sudo usermod -aG docker $USER
newgrp docker

```

#### 서비스 자동 실행 및 검증

```bash
# 시스템 부팅 시 자동 실행 설정
sudo systemctl enable docker.service
sudo systemctl enable containerd.service

# 설치 버전 및 정보 확인
docker version
docker info

```

---

### 4. 컨테이너 실행 및 네트워크 확인

설치된 엔진을 통해 외부 통신이 가능한 컨테이너를 구동합니다.

1. **이미지 검색 및 다운로드:**
```bash
docker search nginx
docker pull nginx

```


2. **웹 서버 컨테이너 구동:**
```bash
docker run -d -p 8080:80 --name web-server nginx

```


* `-d`: 백그라운드(데몬) 모드로 실행
* `-p 8080:80`: 노드 PC의 8080 포트를 컨테이너 80 포트로 매핑



---

### ⚠️ 인프라 운영 참고사항

* **AWS 서비스 연계:** 클라우드 환경에서는 **Amazon ECR**을 이미지 저장소로 사용하며, **AWS Fargate**를 통해 OS 관리 없이 컨테이너를 실행할 수 있습니다.
* **비용 및 라이선스:** 도커 데스크탑은 대규모 기업(직원 250명 이상 또는 연 매출 1,000만 달러 이상)에서 사용 시 **Docker Business** 유료 구독이 필수입니다. 교육 및 개인 용도는 무료입니다.
* **자원 관리:** 실습 종료 후에는 `docker system prune` 명령으로 노드 PC의 스토리지 점유를 해제하십시오.

