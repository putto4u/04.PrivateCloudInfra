쿠버네티스 스토리지 설계의 핵심은 **"데이터가 어디까지 살아남고, 누구와 공유될 수 있는가"**를 결정하는 것입니다. 요청하신 공유 범위의 확장 단계에 따른 스토리지 솔루션 분류 표입니다.

---

## 스토리지 공유 범위 및 확장 계층 분류

| 공유/독점 범위 | 해당 기술 및 리소스 | 데이터 영속성 | 주요 특징 및 용도 |
| --- | --- | --- | --- |
| **컨테이너 독점** | **Container Writable Layer** | 컨테이너 재시작 시 삭제 | 컨테이너 자체의 일시적인 쓰기 공간 |
| **컨테이너 간 공유** (Single Pod) | **emptyDir** | 파드 삭제 시 삭제 | 동일 파드 내 사이드카 컨테이너 간 임시 데이터 교환 |
| **파드 간 공유** (Single Node) | **hostPath** | 노드 유지 (파드 무관) | 동일 노드 내 서로 다른 파드들이 로컬 경로 공유 |
| **노드 간 공유** (Single Cluster) | **PV / PVC** (NFS, AWS EFS 등) | 영구 보존 | 네트워크를 통해 노드 간 데이터 접근 가능 (RWX) |
| **외부 스토리지** (External) | **NAS, SAN, Cloud Storage** | 클러스터 외부에 존재 | 클러스터 장애와 무관한 독립적 데이터 관리 |
| **클러스터 간 공유** (Multi-Cluster) | **Object Storage (S3)** | 전역적 보존 | 리전 및 클러스터 경계를 넘어 전 세계 어디서든 접근 |
Global File System | 전역적 보존 | 리전(Region)이나 클러스터 경계를 넘어 전 세계 어디서든 접근 |

---

## 공유 계층별 상세 분석

### 1. 로컬 계층 (Local Scope)

* **emptyDir:** 파드 내부의 '공유 폴더' 역할을 합니다. 메모리(`Memory`)를 매체로 설정하면 고속 연산용 임시 저장소로 활용 가능합니다.
* **hostPath:** 노드의 특정 디렉터리를 여러 파드가 동시에 바라보게 합니다. 주로 `/var/log`나 `/var/run/docker.sock` 처럼 노드 자원을 직접 공유할 때 쓰입니다.

### 2. 네트워크 계층 (Cluster Scope)

* **PersistentVolume (PV):** 노드에 종속되지 않는 네트워크 기반 저장소입니다. 파드가 노드 A에서 노드 B로 이사 가도 네트워크 주소를 통해 자신의 데이터를 찾아갑니다.
* **RWX (ReadWriteMany):** 여러 노드의 파드들이 동시에 읽고 쓰기 위해서는 반드시 네트워크 스토리지(NFS, EFS 등)가 뒷받침되어야 합니다.

### 3. 글로벌 계층 (Global Scope)

* **외부 저장소 (External):** 쿠버네티스 제어권 밖의 전문 스토리지 장비나 클라우드 서비스를 의미합니다. 클러스터를 새로 구축하더라도 기존 외부 저장소에 연결만 하면 데이터를 즉시 복구할 수 있습니다.
* **클러스터 간 공유:** 멀티 클러스터 환경에서는 **AWS S3**와 같은 객체 스토리지가 표준입니다. HTTP API를 통해 접근하므로 클러스터의 네트워크 구성과 관계없이 데이터를 공유할 수 있습니다.

---

## 실무 아키텍트의 구성 전략

| 상황 | 최적의 선택 | 이유 |
| --- | --- | --- |
| **단순 캐시 데이터 공유** | `emptyDir` | 속도가 빠르고 관리가 필요 없음 |
| **로그 수집 및 노드 모니터링** | `hostPath` | 호스트 시스템의 원천 데이터에 접근 필요 |
| **일반적인 웹 서비스 DB** | `PV (Block Storage)` | 안정적인 성능과 데이터 영속성 보장 |
| **콘텐츠 관리 (CMS) / 정적 파일** | `PV (NFS / EFS)` | 여러 파드가 동일한 콘텐츠를 동시에 서빙 |
| **전역 데이터 / 백업 / 이미지** | **Object Storage** | 위치에 구애받지 않는 무한한 확장성 |

---

## Next Step:

**AWS EFS(네트워크 공유)와 EBS(단일 노드 전용)의 성능 및 비용 비교**

---
쿠버네티스 스토리지 체계에서 '공유'의 반대 개념인 **'독점(Exclusive)'** 또는 **'격리된(Isolated)'** 스토리지의 명칭을 범위별로 정리해 드립니다.

각 계층은 상위 계층으로 갈수록 생명주기가 길어지며, 하위 계층의 데이터는 상위 객체가 삭제될 때 함께 소멸하는 특징을 가집니다.

---


## 요약: 범위에 따른 독점 리소스 명칭

| 범위 | 독점 리소스 명칭 (Keyword) |
| --- | --- |
| **Container** | **Writable Layer / Ephemeral Storage** |
| **Pod** | **emptyDir** |
| **Node** | **Local Volume / hostPath** |
| **Cluster** | **Intra-cluster PV** |

---

## Next Step:

**컨테이너 Writable Layer의 성능 한계와 로그 관리 전략 분석**

가장 좁은 범위인 '컨테이너 독점 스토리지'는 쓰기 속도가 느리고 휘발성이 강하다는 단점이 있습니다. 이를 해결하기 위해 실무에서 로그를 외부로 빼내는 `Sidecar logging` 패턴을 어떻게 구현하는지 확인해 볼까요?
*참고: AWS 환경에서 EBS(Elastic Block Store)는 기본적으로 **노드 독점(RWO)** 성격을 띠며, 비용은 사용량에 따라 과금됩니다.*

---
GitHub의 마크다운 렌더러는 테이블 셀 내의 과도한 `<br>` 태그나 공백에 민감하여 레이아웃이 깨질 수 있습니다. 가독성을 높이면서 깃허브에서 안정적으로 출력되도록 `<br>` 사용을 최소화하고 구조를 최적화하여 다시 제작했습니다.

---
