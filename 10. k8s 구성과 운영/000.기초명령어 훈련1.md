## 명령어 자동완성 설치

```
sudo apt-get update
sudo apt-get install -y bash-completion

```

## 명령어 자동완성 설치

```bash
sudo apt-get update
sudo apt-get install -y bash-completion
source /usr/share/bash-completion/bash_completion
echo 'source <(kubectl completion bash)' >>~/.bashrc
source ~/.bashrc

```

---

# 쿠버네티스(k8s) 기초 반복 숙달 실습 20제

### [Part 1: 파드 생성과 이름 바꾸기 (이름 식별 능력 배양)]

**1. 기본 파드 생성 (my-nginx)**

* **작업:** `my-nginx`라는 이름으로 nginx 파드를 생성하세요.
* **명령어:** `kubectl run my-nginx --image=nginx`
* **결과 확인:** `kubectl get pods` -> `NAME: my-nginx, STATUS: Running`
* **브라우저 확인:** `kubectl port-forward my-nginx 8081:80` 실행 후 브라우저에서 `localhost:8081` 접속
* **에러/해결:** `Invalid name`: 이름에 대문자를 쓰면 에러가 납니다. 소문자, 숫자, 하이픈(-)만 사용하세요.

**2. 다른 이름의 파드 생성 (web-server)**

* **작업:** 동일한 이미지로 `web-server`라는 이름의 파드를 생성하세요.
* **명령어:** `kubectl run web-server --image=nginx`
* **결과 확인:** 파드 목록에 `my-nginx`와 `web-server`가 모두 있는지 확인합니다.
* **브라우저 확인:** `kubectl port-forward web-server 8082:80` 실행 후 브라우저에서 `localhost:8082` 접속

**3. 특정 노드 정보와 함께 조회**

* **작업:** 현재 파드들이 어느 노드(VirtualBox VM 이름)에 떠 있는지 확인하세요.
* **명령어:** `kubectl get pods -o wide`
* **결과 확인:** `web-server`는 `worker-node1`, `my-nginx`는 `worker-node2`에 할당된 것을 확인.

**4. 파드 삭제 반복**

* **작업:** 생성한 `my-nginx` 파드를 삭제하세요.
* **명령어:** `kubectl delete pod my-nginx`
* **결과 확인:** `pod "my-nginx" deleted` 확인 후 목록에서 사라졌는지 체크.

---

### [Part 2: 이미지 오타와 에러 대응 (트러블슈팅 기초)]

**5. 일부러 오타 낸 이미지로 파드 생성**

* **작업:** `nginx-error`라는 이름으로 `nginxxxx`(존재하지 않는 이미지)를 생성하세요.
* **명령어:** `kubectl run nginx-error --image=nginxxxx`
* **결과 확인:** `kubectl get pods` -> `STATUS: ImagePullBackOff` 또는 `ErrImagePull`
* **에러 설명:** 쿠버네티스가 도커 허브에서 해당 이름의 이미지를 찾지 못해 발생합니다.

**6. 에러 원인 상세 분석 (Describe)**

* **작업:** `nginx-error` 파드가 왜 안 뜨는지 상세 로그를 보세요.
* **명령어:** `kubectl describe pod nginx-error`
* **결과 확인:** 하단 `Events:` 섹션에서 `Failed to pull image "nginxxxx": ... not found` 메시지 확인.

**7. 실행 중인 파드 이미지 수정하기**

* **작업:** 에러 난 파드의 이미지를 정상적인 `nginx`로 수정하세요.
* **명령어:** `kubectl edit pod nginx-error` (메모장에서 `image: nginxxxx`를 `nginx`로 수정 후 저장)
* **결과 확인:** `STATUS`가 `Running`으로 변하는지 확인.

---

### [Part 3: 다중 컨테이너와 로그 확인 (내부 들여다보기)]

**8. 파드 내부로 들어가기 (Shell 접속)**

* **작업:** `web-server` 파드 안으로 들어가서 리눅스 명령어를 써보세요.
* **명령어:** `kubectl exec -it web-server -- /bin/bash`
* **결과 확인:** 내부에서 `ls`, `hostname` 입력 시 컨테이너 정보가 출력됨. `exit`로 퇴장.

**9. 실시간 로그 모니터링**

* **작업:** `web-server`에 접속이 들어오는지 로그를 실시간으로 띄워놓으세요.
* **명령어:** `kubectl logs -f web-server`
* **결과 확인:** 다른 터미널에서 `curl <Pod-IP>` 실행 시 실시간으로 접속 로그(Access Log)가 찍히는 것을 확인.

**10. 파드의 IP 주소만 추출하기**

* **작업:** 복잡한 정보 말고 파드의 IP 주소만 화면에 나오게 하세요.
* **명령어:** `kubectl get pod web-server -o jsonpath='{.status.podIP}'`
* **결과 확인:** `10.244.x.x` 형태의 IP 주소만 단독 출력됨.

---

### [Part 4: 라벨과 필터링 (많은 파드 관리하기)]

**11. 라벨 붙여서 생성하기**

* **작업:** `env=dev`라는 라벨을 가진 `dev-pod`을 생성하세요.
* **명령어:** `kubectl run dev-pod --image=nginx --labels="env=dev"`
* **결과 확인:** `kubectl get pods --show-labels` 명령으로 `LABELS` 컬럼 확인.

**12. 특정 라벨만 골라서 보기**

* **작업:** 라벨이 `env=dev`인 파드만 목록에 나오게 하세요.
* **명령어:** `kubectl get pods -l env=dev`
* **결과 확인:** `dev-pod`만 필터링되어 출력되는지 확인.

**13. 기존 파드에 라벨 추가하기**

* **작업:** 아까 만든 `web-server`에 `type=web`이라는 라벨을 추가하세요.
* **명령어:** `kubectl label pod web-server type=web`
* **결과 확인:** `kubectl get pods web-server --show-labels`로 추가된 라벨 확인.

---

### [Part 5: 디플로이먼트 기초 반복 (자동 복구 경험)]

**14. 디플로이먼트 생성 (반복)**

* **작업:** `nginx-deploy`라는 이름으로 파드 2개가 유지되도록 만드세요.
* **명령어:** `kubectl create deployment nginx-deploy --image=nginx --replicas=2`
* **결과 확인:** `kubectl get deploy`, `kubectl get pods`로 2개의 파드 확인.

**15. 강제로 파드 죽여보기 (자생력 확인)**

* **작업:** `nginx-deploy`가 만든 파드 중 하나를 `kubectl delete pod`으로 삭제하세요.
* **결과 확인:** 삭제 직후 `kubectl get pods`를 입력하면 새로운 파드가 생성 중(ContainerCreating)이거나 이미 생성된 것을 확인.

**16. 파드 개수 실시간 변경 (Scale)**

* **작업:** 파드를 2개에서 4개로 늘렸다가 다시 1개로 줄여보세요.
* **명령어:** `kubectl scale deployment nginx-deploy --replicas=4`
* **결과 확인:** `kubectl get pods`에서 파드가 4개로 늘어났는지 확인 후, 다시 1개로 줄여서 확인.

---

### [Part 6: 서비스 연결 기초]

**17. 서비스(Service) 생성으로 통신 열기**

* **작업:** `web-server` 파드에 접속할 수 있는 `web-svc` 통로를 만드세요.
* **명령어:** `kubectl expose pod web-server --name=web-svc --port=80 --type=NodePort`
* **결과 확인:** `kubectl get svc web-svc` 명령어로 `PORT(S)` 항목의 NodePort(30000~32767 사이) 확인.
* **브라우저 확인:** `http://<노드IP>:<NodePort>` 접속하여 Nginx 페이지 확인.

**18. 서비스 이름으로 호출하기**

* **작업:** 클러스터 내부에서 IP가 아닌 '이름'으로 접속이 되는지 확인하세요.
* **명령어:** `kubectl run test-curl --image=curlimages/curl -it --rm -- curl web-svc`
* **결과 확인:** Nginx 초기 화면 HTML 소스가 터미널에 출력되면 성공.

---

### [Part 7: 정리와 초기화]

**19. 모든 리소스 한꺼번에 삭제하기**

* **작업:** 연습했던 모든 파드와 서비스를 삭제하여 클러스터를 깨끗하게 만듭니다.
* **명령어:** `kubectl delete pods,deploy,svc --all`
* **결과 확인:** `pod "..." deleted`, `service "..." deleted` 메시지 확인.

**20. 현재 상태 요약 리포트**

* **작업:** 남아있는 리소스가 없는지 최종 확인합니다.
* **명령어:** `kubectl get all`
* **결과 확인:** `kubernetes` 기본 서비스를 제외하고 아무것도 없어야 함.

---

**Next Step: YAML 파일을 이용한 선언형 객체 생성 및 관리 기초**

* 가상머신(VirtualBox) 사양이 낮을 경우, 너무 많은 파드를 동시에 생성하면 `Pending` 상태(리소스 부족)에 빠질 수 있습니다. 이럴 때는 `kubectl delete`로 안 쓰는 파드를 지워주세요.
* AWS에서 `type=LoadBalancer`를 사용할 경우 로드밸런서 생성에 따른 과금이 발생하므로 실습 후 반드시 삭제해야 합니다. (NodePort 실습은 추가 과금이 없습니다.)

---

**안내:** 요청하신 대로 모든 실습 항목 아래에 결과 확인 및 브라우저 확인 절차를 포함하여 전체 내용을 수정하였습니다. 추가적으로 명령어 자동완성 설정에 필요한 `source` 및 `bashrc` 등록 과정을 보강하였습니다.

Would you like me to:
쿠버네티스 YAML 기초
디플로이먼트 상세 설정
서비스 셀렉터 심화

**Next Step: YAML 파일을 이용한 선언형 객체 생성 및 관리 기초**

* **참고 사항:** 가상머신(VirtualBox) 사양이 낮을 경우, 너무 많은 파드를 동시에 생성하면 `Pending` 상태(리소스 부족)에 빠질 수 있습니다. 이럴 때는 `kubectl delete`로 안 쓰는 파드를 지워주세요. 별도의 클라우드 과금은 발생하지 않습니다.
