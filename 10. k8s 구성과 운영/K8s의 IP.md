쿠버네티스 환경에는 서비스의 영속성과 파드의 동적 관리를 위해 여러 계층의 IP 주소가 존재합니다. 각 IP의 역할과 통신 범위를 이해하는 것은 아키텍처 설계와 트러블슈팅의 핵심입니다.

---

## 1. 노드 IP (Node IP)

클러스터를 구성하는 물리적인 서버 또는 가상 머신(VM)에 할당된 실제 IP입니다.

* **용도:** 마스터 노드와 워커 노드 간의 통신, 외부에서 클러스터 노드에 접근할 때 사용됩니다.
* **특징:** 외부 네트워크와 연결되는 실제 주소입니다.
* **확인:** `kubectl get nodes -o wide`

## 2. 파드 IP (Pod IP)

클러스터 내의 각 파드(Pod)가 할당받는 가상 IP입니다.

* **용도:** 클러스터 내부에서 파드 간 직접 통신에 사용됩니다.
* **특징:** 파드는 생성되고 삭제될 때마다 IP가 변하는 **휘발성(Ephemeral)** 주소입니다. CNI(Calico, Flannel 등)에 의해 관리됩니다.
* **확인:** `kubectl get pods -o wide`

## 3. 서비스 IP (ClusterIP)

파드 집합에 접근하기 위해 부여되는 고정적인 가상 IP입니다.

* **용도:** 파드가 재생성되어 IP가 바뀌더라도 서비스 IP는 변하지 않으므로, 안정적인 엔드포인트를 제공합니다.
* **특징:** 클러스터 내부에서만 유효한 가상 IP이며, 실제 인터페이스가 아닌 `iptables`나 `IPVS` 규칙으로 동작합니다.
* **확인:** `kubectl get svc`

## 4. 노드포트 (NodePort)

모든 노드의 특정 포트를 개방하여 외부 트래픽을 서비스로 전달하는 방식입니다.

* **용도:** 외부에서 클러스터 내부 서비스에 접속할 때 사용합니다.
* **특징:** `<NodeIP>:<NodePort>` 형태로 접속하며, 포트 범위는 기본적으로 30000~32767 사이입니다.

## 5. 로드밸런서 IP (External IP)

클라우드 제공자(AWS, GCP 등)의 로드밸런서를 통해 할당받는 외부 공인 IP입니다.

* **용도:** 인터넷을 통해 실제 서비스 사용자가 접속하는 최종 주소입니다.
* **특징:** 클라우드 인프라와 연동되며, **AWS 기준 ELB/NLB 생성에 따른 추가 과금**이 발생합니다.
* **확인:** `kubectl get svc` 명령의 `EXTERNAL-IP` 항목

---

## 요약 및 비교

| 구분 | 할당 대상 | 범위 | 영속성 |
| --- | --- | --- | --- |
| **Node IP** | 호스트 (VM/Bare metal) | 외부/내부 | 높음 |
| **Pod IP** | 개별 컨테이너 그룹 | 클러스터 내부 | 낮음 (휘발성) |
| **ClusterIP** | 서비스 (Service) | 클러스터 내부 | 높음 (고정) |
| **External IP** | 로드밸런서 (LoadBalancer) | 외부 (Public) | 높음 (고정) |

---

**Next Step: `kube-proxy`의 동작 모드(Userspace, iptables, IPVS)에 따른 IP 라우팅 원리**

---

수강생들이 가장 혼란스러워하는 "왜 파드 IP가 있는데 서비스 IP를 또 쓰는지"에 대한 핵심(휘발성 vs 고정성)을 강조하여 정리했습니다. 특히 로드밸런서 사용 시 발생할 수 있는 AWS 과금 안내를 포함하여 실무적인 주의사항을 덧붙였습니다. 추가로 필요하신 내용이 있다면 말씀해 주세요.
