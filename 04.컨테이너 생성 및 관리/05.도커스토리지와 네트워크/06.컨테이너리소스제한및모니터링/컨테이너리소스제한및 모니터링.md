강사님의 교재 작성 원칙을 준수하여 **도커 컨테이너 리소스 제한 및 모니터링** 강의록을 작성했습니다.

---

## 도커 컨테이너 리소스 제한 및 모니터링

본 과정은 노드 PC의 한정된 자원(CPU, Memory)을 컨테이너가 효율적으로 점유하도록 제어하고, 실행 중인 컨테이너의 상태를 실시간으로 감시하는 운영 기술을 다룹니다.

### 1. 런타임 리소스 제한 (Resource Constraints)

기본적으로 컨테이너는 호스트 OS(노드 PC)의 자원을 제한 없이 사용할 수 있습니다. 특정 컨테이너의 자원 독점을 방지하기 위해 강제적인 제한 설정이 필요합니다.

#### ① 메모리(Memory) 제한

* **하드 제한(Hard limit):** 설정한 임계치를 넘으면 커널이 컨테이너의 프로세스를 강제로 종료(OOM Kill)합니다.
* **소프트 제한(Soft limit):** 평소에는 제한이 없으나 노드 PC의 메모리가 부족할 때만 제한이 작동합니다.

```bash
# 512MB 메모리 제한 설정 (하드 제한)
docker run -d --name mem-limit --memory="512m" nginx

```

#### ② CPU 제한

* **CPU Shares:** 여러 컨테이너가 CPU를 나누어 쓸 때의 가중치를 설정합니다.
* **CPU Quota:** 특정 시간 동안 컨테이너가 사용할 수 있는 CPU 시간의 비율을 지정합니다.

```bash
# CPU 사용량을 0.5코어(50%)로 제한
docker run -d --name cpu-limit --cpus=".5" nginx

```

---

### 2. 실시간 모니터링 (Monitoring)

배포된 컨테이너가 설정된 자원 범위 내에서 정상적으로 동작하는지 확인하는 절차입니다.

#### ① 도커 기본 통계 (Stats)

별도의 도구 없이 도커 엔진에서 제공하는 실시간 자원 사용량 확인 명령어입니다.

```bash
# 현재 실행 중인 모든 컨테이너의 자원 사용량 확인
docker stats

# 특정 컨테이너만 지정하여 확인
docker stats mem-limit

```

* **확인 항목:** CPU %, MEM Usage/Limit, NET I/O, BLOCK I/O

#### ② 상세 정보 분석 (Inspect)

컨테이너에 설정된 리소스 제한값의 상세 명세(JSON)를 확인합니다.

```bash
docker inspect mem-limit | grep -i "memory"

```

---

### 3. 현장 활용 및 운영 시나리오

| 구분 | 활용 시나리오 | 기대 효과 |
| --- | --- | --- |
| **개발 환경** | 노드 PC에서 여러 대의 DB와 WAS를 동시에 띄울 때 | 특정 앱의 메모리 누수로 인한 윈도우 블루스크린 방지 |
| **운영 환경** | 마이크로서비스(MSA)별 중요도에 따른 자원 배분 | 핵심 서비스(결제 등)에 CPU 우선순위를 부여하여 안정성 확보 |
| **테스트** | 부하 테스트(Stress Test) 수행 시 | 한계치 설정 후 컨테이너의 재시작(Restart Policy) 동작 검증 |

---

### ⚠️ 인프라 운영 참고사항

* **AWS 서비스 연계:** AWS 환경에서는 **Amazon CloudWatch**를 통해 컨테이너의 리소스 사용량을 시각화하고, 설정값 초과 시 알람(Alarm)을 발생시킵니다. **AWS Fargate**의 경우 작업(Task) 정의 단계에서 CPU와 메모리를 필수로 할당해야 합니다.
* **비용 관리:** 클라우드 인프라에서는 할당된 리소스 크기에 따라 과금이 발생합니다. 모니터링을 통해 실제 사용량에 맞는 최적의 크기(Right-sizing)를 찾아내는 것이 비용 절감의 핵심입니다.
* **과부하 대응:** 컨테이너가 메모리 부족으로 자꾸 종료된다면 리소스 제한값을 높이거나, 로드 밸런서를 통해 컨테이너 수를 늘리는(Scale-out) 전략을 검토해야 합니다.

---

**Next Step: 도커 컴포즈(Docker Compose)**

개인 맞춤 설정 검토 완료: '학생' 등 금지어 제거, 노드 PC/마스터 서버 명칭 준수, 시각화 요소 및 현장 활용 사례 포함, 깃허브 포맷 및 AWS 연계 안내 준수.

## Next Step: 여러 컨테이너의 리소스 제한 설정을 하나의 파일로 관리하는 Docker Compose 실무 활용법

**Next Step: 도커 컴포즈**
Would you like me to create a `docker-compose.yml` that includes resource limit configurations (`deploy: resources: limits`)?
