오타를 바로잡아 네임스페이스 `prod-ingress` 내에서 `front-web`과 `view-web` 서비스를 경로별로 분기하는 전체 구성을 정리해 드립니다.

---

## 경로(Path) 기반 Ingress 라우팅 실습

사용자가 접속하는 URL 경로에 따라 서로 다른 애플리케이션으로 연결하는 방식을 학습합니다. 이 방식은 하나의 로드밸런서(IP/도메인)를 공유하면서 여러 서비스를 운영할 때 매우 유용합니다.

### 1. 사전 작업 (Prerequisites)

실습을 시작하기 전에 다음 사항이 준비되어야 합니다.

1. **Ingress Controller 활성화:** 클러스터에 Nginx Ingress Controller가 설치되어 있어야 합니다. (Docker Desktop 또는 Minikube 사용 시 별도의 활성화 필요)
2. **네임스페이스 생성:** 격리된 환경을 위해 네임스페이스를 생성합니다.
```bash
kubectl create namespace prod-ingress

```


3. **파일 준비:** 아래 YAML 내용을 `ingress-routing.yaml` 파일로 저장합니다.

### 2. 쿠버네티스 리소스 배포 (YAML)

이 파일에는 2개의 Deployment, 2개의 Service, 그리고 1개의 공용 Ingress 설정이 포함되어 있습니다.

```yaml
# 1. Front-end 서비스 (front-web)
apiVersion: apps/v1
kind: Deployment
metadata:
  name: front-web-deploy
  namespace: prod-ingress
spec:
  replicas: 2
  selector:
    matchLabels:
      app: front-web
  template:
    metadata:
      labels:
        app: front-web
    spec:
      containers:
      - name: nginx
        image: nginx:latest
        ports:
        - containerPort: 80
---
apiVersion: v1
kind: Service
metadata:
  name: front-web-svc
  namespace: prod-ingress
spec:
  selector:
    app: front-web
  ports:
    - protocol: TCP
      port: 80
      targetPort: 80
---
# 2. View 서비스 (view-web)
apiVersion: apps/v1
kind: Deployment
metadata:
  name: view-web-deploy
  namespace: prod-ingress
spec:
  replicas: 2
  selector:
    matchLabels:
      app: view-web
  template:
    metadata:
      labels:
        app: view-web
    spec:
      containers:
      - name: nginx
        image: nginx:latest
        ports:
        - containerPort: 80
---
apiVersion: v1
kind: Service
metadata:
  name: view-web-svc
  namespace: prod-ingress
spec:
  selector:
    app: view-web
  ports:
    - protocol: TCP
      port: 80
      targetPort: 80
---
# 3. 공용 Ingress 설정
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: shared-ingress
  namespace: prod-ingress
  annotations:
    kubernetes.io/ingress.class: "nginx"
    # 경로 재작성을 통해 /viewlist 접근 시에도 서비스의 루트(/) index.html을 찾게 합니다.
    nginx.ingress.kubernetes.io/rewrite-target: /
spec:
  rules:
  - http:
      paths:
      - path: /
        pathType: Prefix
        backend:
          service:
            name: front-web-svc
            port:
              number: 80
      - path: /viewlist
        pathType: Prefix
        backend:
          service:
            name: view-web-svc
            port:
              number: 80

```

### 3. 실행 방법 및 절차

1. **리소스 생성:** YAML 파일을 클러스터에 적용합니다.
```bash
kubectl apply -f ingress-routing.yaml

```


2. **배포 확인:** `prod-ingress` 네임스페이스의 모든 리소스가 정상 가동 중인지 확인합니다.
```bash
kubectl get all -n prod-ingress

```


3. **Ingress 주소 확인:** 외부에서 접속할 IP 또는 주소를 확인합니다.
```bash
kubectl get ingress -n prod-ingress

```


* `ADDRESS` 항목에 표시되는 IP를 확인합니다. (클라우드 환경은 수 분 소요)



### 4. 실전 팁 및 주의사항

* **Rewrite Target의 역할:** 엔드포인트가 `/viewlist`일 때, 실제 `view-web` 컨테이너 내부에는 `/viewlist/index.html`이라는 파일이 없을 가능성이 큽니다. `rewrite-target: /` 설정을 통해 외부의 `/viewlist` 요청을 내부의 `/` 요청으로 변환하여 `index.html`이 정상적으로 표시되도록 합니다.
* **Pod 개수 유지:** `replicas: 2`로 설정되어 있으므로, 하나의 Pod에 문제가 생겨도 서비스 중단 없이 운영되는 고가용성(HA)을 보장합니다.

> [!CAUTION] **AWS 과금 주의**
> * **ALB Controller 사용 시:** 위 설정을 AWS 환경에서 실행하면 **Application Load Balancer(ALB)가 생성되며 시간당 비용**이 청구됩니다. 실습 후 반드시 리소스를 삭제(`kubectl delete`)하십시오.
> 
> 

---

Next Step: Ingress 도메인 네임 연결 및 SSL(HTTPS) 적용

수정 요청하신 `front-web` 명칭을 반영하고 네임스페이스 및 서비스별 분기 설정을 상세히 작성했습니다. 추가적인 보완이 필요하시면 말씀해 주세요.
