ë„¤ì„ìŠ¤í˜ì´ìŠ¤ `prod-ingress` ë‚´ì—ì„œ ê´€ë¦¬ í¸ì˜ì„±ì„ ìœ„í•´ ê° ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ë°°í¬ ì„¤ì •(Deployment/Service)ê³¼ Ingress ì„¤ì •ì„ ë³„ë„ì˜ íŒŒì¼ë¡œ ë¶„ë¦¬í•˜ì—¬ êµ¬ì„±í•˜ëŠ” ë°©ì‹ì…ë‹ˆë‹¤. ì‹¤ë¬´ì—ì„œëŠ” ì„œë¹„ìŠ¤ ë‹¨ìœ„ë¡œ íŒŒì¼ì„ ë‚˜ëˆ„ì–´ ê´€ë¦¬í•˜ëŠ” ê²ƒì´ ì¼ë°˜ì ì…ë‹ˆë‹¤.

---

## ì„œë¹„ìŠ¤ë³„ ë¦¬ì†ŒìŠ¤ ë¶„ë¦¬ ë° ê´€ë¦¬

ëŒ€ê·œëª¨ ì‹œìŠ¤í…œì—ì„œëŠ” ëª¨ë“  ì„¤ì •ì„ í•˜ë‚˜ì˜ íŒŒì¼ì— ë„£ê¸°ë³´ë‹¤, ì„œë¹„ìŠ¤ë³„ë¡œ íŒŒì¼ì„ ë¶„ë¦¬í•˜ì—¬ ìœ ì§€ë³´ìˆ˜ì„±ì„ ë†’ì…ë‹ˆë‹¤. ì—¬ê¸°ì„œëŠ” `front-web`ê³¼ `view-web`, ê·¸ë¦¬ê³  ì´ë¥¼ ì—°ê²°í•˜ëŠ” `ingress` íŒŒì¼ì„ ê°ê° ë‚˜ëˆ„ì–´ êµ¬ì„±í•©ë‹ˆë‹¤.

### 1. ì‚¬ì „ ì‘ì—… (Prerequisites)

ì‹¤ìŠµì„ ìœ„í•´ ë„¤ì„ìŠ¤í˜ì´ìŠ¤ë¥¼ ìƒì„±í•˜ê³ , íŒŒì¼ë“¤ì„ ì €ì¥í•  ë””ë ‰í† ë¦¬ë¥¼ ì¤€ë¹„í•©ë‹ˆë‹¤.

1. **ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ìƒì„±:** ```bash
kubectl create namespace prod-ingress
```

```


2. **íŒŒì¼ ìƒì„±:** ì•„ë˜ ì œê³µë˜ëŠ” 3ê°œì˜ YAML ì½”ë“œë¥¼ ê°ê° í•´ë‹¹ íŒŒì¼ëª…ìœ¼ë¡œ ì €ì¥í•©ë‹ˆë‹¤.

---

### 2. [íŒŒì¼ 1] Front-end ë°°í¬ ì„¤ì • (`front-web.yaml`)

ë©”ì¸ ì›¹ ì„œë¹„ìŠ¤ë¥¼ ë‹´ë‹¹í•˜ë©°, 2ê°œì˜ Podë¡œ êµ¬ì„±ë©ë‹ˆë‹¤.

```yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: front-web-deploy
  namespace: prod-ingress
spec:
  replicas: 2
  selector:
    matchLabels:
      app: front-web
  template:
    metadata:
      labels:
        app: front-web
    spec:
      containers:
      - name: nginx
        image: nginx:latest
        ports:
        - containerPort: 80
---
apiVersion: v1
kind: Service
metadata:
  name: front-web-svc
  namespace: prod-ingress
spec:
  selector:
    app: front-web
  ports:
    - protocol: TCP
      port: 80
      targetPort: 80

```

---

### 3. [íŒŒì¼ 2] View-list ë°°í¬ ì„¤ì • (`view-web.yaml`)

ëª©ë¡ ì¡°íšŒë¥¼ ë‹´ë‹¹í•˜ëŠ” ë³„ë„ì˜ ì„œë¹„ìŠ¤ì´ë©°, ì—­ì‹œ 2ê°œì˜ Podë¡œ êµ¬ì„±ë©ë‹ˆë‹¤.

```yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: view-web-deploy
  namespace: prod-ingress
spec:
  replicas: 2
  selector:
    matchLabels:
      app: view-web
  template:
    metadata:
      labels:
        app: view-web
    spec:
      containers:
      - name: nginx
        image: nginx:latest
        ports:
        - containerPort: 80
---
apiVersion: v1
kind: Service
metadata:
  name: view-web-svc
  namespace: prod-ingress
spec:
  selector:
    app: view-web
  ports:
    - protocol: TCP
      port: 80
      targetPort: 80

```

---

### 4. [íŒŒì¼ 3] ê³µìš© Ingress ì„¤ì • (`shared-ingress.yaml`)

ë‘ ì„œë¹„ìŠ¤ë¥¼ í•˜ë‚˜ì˜ ì™¸ë¶€ IP/ë„ë©”ì¸ìœ¼ë¡œ ë¬¶ì–´ì£¼ëŠ” ë¼ìš°íŒ… ì„¤ì • íŒŒì¼ì…ë‹ˆë‹¤.

```yaml
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: shared-ingress
  namespace: prod-ingress
  annotations:
    kubernetes.io/ingress.class: "nginx"
    # ì™¸ë¶€ ê²½ë¡œ(/viewlist)ë¥¼ ë‚´ë¶€ ì„œë¹„ìŠ¤ì˜ ë£¨íŠ¸(/)ë¡œ ì—°ê²°
    nginx.ingress.kubernetes.io/rewrite-target: /
spec:
  rules:
  - http:
      paths:
      - path: /
        pathType: Prefix
        backend:
          service:
            name: front-web-svc
            port:
              number: 80
      - path: /viewlist
        pathType: Prefix
        backend:
          service:
            name: view-web-svc
            port:
              number: 80

```

---

### 5. ì‹¤í–‰ ë°©ë²• ë° ì ˆì°¨ ìƒì„¸

1. **ì „ì²´ ë¦¬ì†ŒìŠ¤ ì ìš©:**
í˜„ì¬ ë””ë ‰í† ë¦¬ì— ìˆëŠ” ëª¨ë“  YAML íŒŒì¼ì„ í•œ ë²ˆì— ì‹¤í–‰í•˜ê±°ë‚˜ ìˆœì„œëŒ€ë¡œ ì‹¤í–‰í•©ë‹ˆë‹¤.
```bash
# ë””ë ‰í† ë¦¬ ë‚´ ëª¨ë“  íŒŒì¼ ì ìš© ì‹œ
kubectl apply -f .

# ë˜ëŠ” ê°œë³„ íŒŒì¼ ì ìš© ì‹œ
kubectl apply -f front-web.yaml
kubectl apply -f view-web.yaml
kubectl apply -f shared-ingress.yaml

```


2. **ë°°í¬ ìƒíƒœ í™•ì¸:**
```bash
kubectl get all,ing -n prod-ingress

```


3. **ì ‘ì† í…ŒìŠ¤íŠ¸:**
* **Main Page:** `http://<Ingress-IP>/` -> `front-web` Pod ì—°ê²° í™•ì¸
* **List Page:** `http://<Ingress-IP>/viewlist` -> `view-web` Pod ì—°ê²° í™•ì¸



### ğŸ’¡ ì‹¤ì „ íŒ: íŒŒì¼ ë¶„ë¦¬ì˜ ì¥ì 

* **ë…ë¦½ì  ì—…ë°ì´íŠ¸:** `view-web` ì„œë¹„ìŠ¤ë§Œ ìˆ˜ì •ì´ í•„ìš”í•  ë•Œ `view-web.yaml`ë§Œ ìˆ˜ì •í•˜ì—¬ ë°°í¬í•˜ë©´ ë˜ë¯€ë¡œ ë‹¤ë¥¸ ì„œë¹„ìŠ¤ì— ì˜í–¥ì„ ì¤„ ìœ„í—˜ì´ ì¤„ì–´ë“­ë‹ˆë‹¤.
* **Git ê´€ë¦¬ ìš©ì´:** Gitê³¼ ê°™ì€ ë²„ì „ ê´€ë¦¬ ì‹œìŠ¤í…œì—ì„œ ë³€ê²½ ì´ë ¥ì„ ì¶”ì í•˜ê¸° í›¨ì”¬ ëª…í™•í•©ë‹ˆë‹¤.

> [!CAUTION] **AWS ê³¼ê¸ˆ ì£¼ì˜**
> * **ALB(Application Load Balancer) ì‚¬ìš© ì‹œ:** AWS Load Balancer Controllerë¥¼ í†µí•´ Ingressë¥¼ ìƒì„±í•˜ë©´ **AWSì—ì„œ ALB ìì›ì´ ìƒì„±ë˜ë©° ì‹œê°„ë‹¹ ìš”ê¸ˆì´ ë¶€ê³¼**ë©ë‹ˆë‹¤. ì‹¤ìŠµì´ ëë‚˜ë©´ `kubectl delete -f .` ëª…ë ¹ì–´ë¡œ ë°˜ë“œì‹œ ë¦¬ì†ŒìŠ¤ë¥¼ ì‚­ì œí•´ ì£¼ì„¸ìš”.
> 
> 

---

Next Step: Ingress ë°°í¬ ìë™í™”ë¥¼ ìœ„í•œ Helm ì°¨íŠ¸ êµ¬ì„± ê¸°ì´ˆ

ìš”ì²­í•˜ì‹  ëŒ€ë¡œ Deploymentì™€ Ingress íŒŒì¼ì„ ê°ê° ë¶„ë¦¬í•˜ì—¬ ì‹¤ë¬´í˜• êµì¬ ì–‘ì‹ìœ¼ë¡œ êµ¬ì„±í–ˆìŠµë‹ˆë‹¤. ì¶”ê°€ë¡œ ìˆ˜ì •ì´ í•„ìš”í•œ ë¶€ë¶„ì´ ìˆë‹¤ë©´ ë§ì”€í•´ ì£¼ì„¸ìš”.
