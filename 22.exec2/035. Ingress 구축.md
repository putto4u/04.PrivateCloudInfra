ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ì´ë¦„ì„ `megaprod`ë¡œ ë³€ê²½í•˜ì—¬ ë¦¬ì†ŒìŠ¤ ë¶„ë¦¬ ë° ê´€ë¦¬ ë°©ì‹ì„ ì„¤ëª…í•˜ëŠ” êµì¬ë¥¼ ë‹¤ì‹œ êµ¬ì„±í•´ ë“œë¦½ë‹ˆë‹¤.

---

## ì„œë¹„ìŠ¤ë³„ ë¦¬ì†ŒìŠ¤ ë¶„ë¦¬ ë° ê´€ë¦¬ (Namespace: megaprod)

ëŒ€ê·œëª¨ í”„ë¡œì íŠ¸ë‚˜ ìš´ì˜ í™˜ê²½ì—ì„œëŠ” ëª¨ë“  ì„¤ì •ì„ í•˜ë‚˜ì˜ íŒŒì¼ì— ë„£ê¸°ë³´ë‹¤ ì„œë¹„ìŠ¤ ë‹¨ìœ„ë¡œ íŒŒì¼ì„ ë¶„ë¦¬í•˜ì—¬ ê´€ë¦¬í•©ë‹ˆë‹¤. ì´ë¥¼ í†µí•´ ê°€ë…ì„±ì„ ë†’ì´ê³  íŠ¹ì • ì„œë¹„ìŠ¤ë§Œ ë…ë¦½ì ìœ¼ë¡œ ì—…ë°ì´íŠ¸í•  ìˆ˜ ìˆëŠ” êµ¬ì¡°ë¥¼ ë§Œë“­ë‹ˆë‹¤.

### 1. ì‚¬ì „ ì‘ì—… (Prerequisites)

ì‹¤ìŠµì„ ìœ„í•´ ì „ìš© ë„¤ì„ìŠ¤í˜ì´ìŠ¤ë¥¼ ìƒì„±í•˜ê³  íŒŒì¼ì„ ê´€ë¦¬í•  ë””ë ‰í† ë¦¬ë¥¼ ì¤€ë¹„í•©ë‹ˆë‹¤.

1. **ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ìƒì„±:**
```bash
kubectl create namespace megaprod

```


2. **íŒŒì¼ ì¤€ë¹„:** ì•„ë˜ 3ê°œì˜ YAML ì½”ë“œë¥¼ ê°ê° í•´ë‹¹ íŒŒì¼ëª…ìœ¼ë¡œ ì €ì¥í•©ë‹ˆë‹¤.

---

### 2. [íŒŒì¼ 1] Front-end ë°°í¬ ì„¤ì • (`front-web.yaml`)

ë©”ì¸ ì›¹ í˜ì´ì§€ë¥¼ ì²˜ë¦¬í•˜ëŠ” ì„œë¹„ìŠ¤ë¡œ, ê³ ê°€ìš©ì„±ì„ ìœ„í•´ 2ê°œì˜ Podê°€ ìƒì„±ë©ë‹ˆë‹¤.

```yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: front-web-deploy
  namespace: megaprod
spec:
  replicas: 2
  selector:
    matchLabels:
      app: front-web
  template:
    metadata:
      labels:
        app: front-web
    spec:
      containers:
      - name: nginx
        image: nginx:latest
        ports:
        - containerPort: 80
---
apiVersion: v1
kind: Service
metadata:
  name: front-web-svc
  namespace: megaprod
spec:
  selector:
    app: front-web
  ports:
    - protocol: TCP
      port: 80
      targetPort: 80

```

---

### 3. [íŒŒì¼ 2] View-list ë°°í¬ ì„¤ì • (`view-web.yaml`)

íŠ¹ì • ê²½ë¡œ(`/viewlist`)ë¥¼ ì²˜ë¦¬í•˜ëŠ” ë³„ë„ì˜ ì›¹ ì„œë¹„ìŠ¤ì…ë‹ˆë‹¤. ë…ë¦½ì ì¸ Deploymentë¡œ ê´€ë¦¬ë©ë‹ˆë‹¤.

```yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: view-web-deploy
  namespace: megaprod
spec:
  replicas: 2
  selector:
    matchLabels:
      app: view-web
  template:
    metadata:
      labels:
        app: view-web
    spec:
      containers:
      - name: nginx
        image: nginx:latest
        ports:
        - containerPort: 80
---
apiVersion: v1
kind: Service
metadata:
  name: view-web-svc
  namespace: megaprod
spec:
  selector:
    app: view-web
  ports:
    - protocol: TCP
      port: 80
      targetPort: 80

```

---

### 4. [íŒŒì¼ 3] ê³µìš© Ingress ì„¤ì • (`shared-ingress.yaml`)

`megaprod` ë„¤ì„ìŠ¤í˜ì´ìŠ¤ì˜ ë‘ ì„œë¹„ìŠ¤ë¥¼ ì™¸ë¶€ë¡œ ë…¸ì¶œí•˜ëŠ” ë‹¨ì¼ ì§„ì…ì ì…ë‹ˆë‹¤.

```yaml
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: shared-ingress
  namespace: megaprod
  annotations:
    kubernetes.io/ingress.class: "nginx"
    # ì‚¬ìš©ìê°€ /viewlistë¡œ ë“¤ì–´ì™€ë„ ë‚´ë¶€ì—ì„œëŠ” ë£¨íŠ¸(/) index.htmlì„ ì°¾ë„ë¡ ì¬ì‘ì„±
    nginx.ingress.kubernetes.io/rewrite-target: /
spec:
  rules:
  - http:
      paths:
      - path: /
        pathType: Prefix
        backend:
          service:
            name: front-web-svc
            port:
              number: 80
      - path: /viewlist
        pathType: Prefix
        backend:
          service:
            name: view-web-svc
            port:
              number: 80

```

---

### 5. ì‹¤í–‰ ë°©ë²• ë° ì ˆì°¨ ìƒì„¸

1. **ì „ì²´ ë¦¬ì†ŒìŠ¤ ì ìš©:**
í˜„ì¬ ë””ë ‰í† ë¦¬ì˜ ëª¨ë“  ì„¤ì • íŒŒì¼ì„ ì¼ê´„ ì ìš©í•©ë‹ˆë‹¤.
```bash
kubectl apply -f .

```


2. **ìƒíƒœ ëª¨ë‹ˆí„°ë§:**
`megaprod` ë„¤ì„ìŠ¤í˜ì´ìŠ¤ì˜ Pod, Service, Ingress ìƒíƒœë¥¼ í•œëˆˆì— í™•ì¸í•©ë‹ˆë‹¤.
```bash
kubectl get all,ing -n megaprod

```


3. **ìµœì¢… ì ‘ì† í…ŒìŠ¤íŠ¸:**
* **ê¸°ë³¸ ê²½ë¡œ:** `http://<Ingress-IP>/` ì ‘ì† ì‹œ `front-web`ì˜ í™”ë©´ ì¶œë ¥
* **ì¡°íšŒ ê²½ë¡œ:** `http://<Ingress-IP>/viewlist` ì ‘ì† ì‹œ `view-web`ì˜ í™”ë©´ ì¶œë ¥



### ğŸ’¡ ì‹¤ë¬´ ê°€ì´ë“œ: ì™œ ë„¤ì„ìŠ¤í˜ì´ìŠ¤ë¥¼ ë¶„ë¦¬í•˜ëŠ”ê°€?

* **ìì› ê²©ë¦¬:** ë™ì¼ í´ëŸ¬ìŠ¤í„° ë‚´ì—ì„œ í”„ë¡œì íŠ¸ë³„(`megaprod`, `dev-stage` ë“±)ë¡œ ìì›ì„ ì™„ë²½íˆ ë¶„ë¦¬í•˜ì—¬ ê´€ë¦¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
* **ë³´ì•ˆ ê¶Œí•œ:** íŠ¹ì • ì‚¬ìš©ìì—ê²Œ `megaprod` ë„¤ì„ìŠ¤í˜ì´ìŠ¤ì— ëŒ€í•œ ì ‘ê·¼ ê¶Œí•œë§Œ ë¶€ì—¬í•˜ëŠ” ë°©ì‹(RBAC)ìœ¼ë¡œ ìš´ì˜ ë³´ì•ˆì„ ê°•í™”í•©ë‹ˆë‹¤.

> [!CAUTION] **AWS ê³¼ê¸ˆ ì£¼ì˜**
> * **AWS Load Balancer:** ì´ ì„¤ì •ì„ AWS í™˜ê²½ì—ì„œ ì‹¤í–‰í•˜ë©´ **Application Load Balancer(ALB)ê°€ ì¦‰ì‹œ ìƒì„±ë˜ì–´ ì‹œê°„ë‹¹ ìš”ê¸ˆì´ ë¶€ê³¼**ë©ë‹ˆë‹¤. ì‹¤ìŠµ í›„ì—ëŠ” ë°˜ë“œì‹œ `kubectl delete namespace megaprod` ëª…ë ¹ì–´ë¡œ ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ì „ì²´ë¥¼ ì‚­ì œí•˜ì—¬ ë¶ˆí•„ìš”í•œ ë¹„ìš©ì„ ì°¨ë‹¨í•˜ì‹­ì‹œì˜¤.
> 
> 

---

Next Step: Ingress ë„ë©”ì¸ ë„¤ì„ ì—°ê²° ë° SSL(HTTPS) ì ìš©

ìš”ì²­í•˜ì‹  ëŒ€ë¡œ ë„¤ì„ìŠ¤í˜ì´ìŠ¤ë¥¼ `megaprod`ë¡œ ë³€ê²½í•˜ê³  ë¦¬ì†ŒìŠ¤ë¥¼ ì™„ë²½íˆ ë¶„ë¦¬í•˜ì—¬ êµì¬ë¥¼ ì—…ë°ì´íŠ¸í–ˆìŠµë‹ˆë‹¤. ì¶”ê°€ë¡œ ë‹¤ë£¨ê³  ì‹¶ì€ ì£¼ì œê°€ ìˆë‹¤ë©´ ì•Œë ¤ì£¼ì„¸ìš”.
