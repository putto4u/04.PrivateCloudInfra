## ë©€í‹° ë„¤ì„ìŠ¤í˜ì´ìŠ¤ í™˜ê²½ì—ì„œì˜ Ingress í™œìš© ë° ê²©ë¦¬ ì „ëµ

ì¿ ë²„ë„¤í‹°ìŠ¤ ìš´ì˜ ì•„í‚¤í…ì²˜ì—ì„œ ì¸ê·¸ë ˆìŠ¤(Ingress)ë¥¼ í™œìš©í•˜ì—¬ ì—¬ëŸ¬ ë„¤ì„ìŠ¤í˜ì´ìŠ¤(`megaprod`, `megadev`)ì— ì„œë¹„ìŠ¤ë¥¼ ë…¸ì¶œí•˜ëŠ” ë°©ë²•ì€ í¬ê²Œ ë‘ ê°€ì§€ë¡œ ë‚˜ë‰©ë‹ˆë‹¤. í•˜ë‚˜ì˜ ì»¨íŠ¸ë¡¤ëŸ¬ë¡œ í†µí•© ê´€ë¦¬í•˜ëŠ” **ê³µìœ í˜• ì•„í‚¤í…ì²˜**ì™€ ê° ë„¤ì„ìŠ¤í˜ì´ìŠ¤ì— ì „ìš© ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ ë‘ëŠ” **ê²©ë¦¬í˜• ì•„í‚¤í…ì²˜**ì…ë‹ˆë‹¤.

---

### [Case 1] ê³µìœ í˜• ì¸ê·¸ë ˆìŠ¤ ì•„í‚¤í…ì²˜ (í†µí•© ê´€ë¦¬)

ì´ë¯¸ ì„¤ì¹˜ëœ í•˜ë‚˜ì˜ ì¸ê·¸ë ˆìŠ¤ ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ ì‚¬ìš©í•˜ì—¬ ì—¬ëŸ¬ ë„¤ì„ìŠ¤í˜ì´ìŠ¤ì˜ íŠ¸ë˜í”½ì„ ë¶„ê¸°í•˜ëŠ” íš¨ìœ¨ì ì¸ ë°©ì‹ì…ë‹ˆë‹¤.

#### 1. ì¸ê·¸ë ˆìŠ¤ ì„¤ì • íŒŒì¼ ì‘ì„±

* **íŒŒì¼ëª…**: `shared-ingress.yaml`

```yaml
# ìš´ì˜ í™˜ê²½ìš© (megaprod)
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: prod-ingress
  namespace: megaprod
spec:
  ingressClassName: nginx
  rules:
  - host: prod.mega-it.com
    http:
      paths:
      - path: /
        pathType: Prefix
        backend:
          service:
            name: prod-service
            port:
              number: 80
---
# ê°œë°œ í™˜ê²½ìš© (megadev)
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: dev-ingress
  namespace: megadev
spec:
  ingressClassName: nginx
  rules:
  - host: dev.mega-it.com
    http:
      paths:
      - path: /
        pathType: Prefix
        backend:
          service:
            name: dev-service
            port:
              number: 80

```

#### 2. ì‹¤í–‰ ë° í™•ì¸ ë°©ë²•

```bash
# ì¸ê·¸ë ˆìŠ¤ ê·œì¹™ ì ìš©
kubectl apply -f shared-ingress.yaml

# ì ìš© ê²°ê³¼ í™•ì¸
kubectl get ingress -A

```

---

### [Case 2] ê²©ë¦¬í˜• ì¸ê·¸ë ˆìŠ¤ ì•„í‚¤í…ì²˜ (ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ì „ìš©)

ë³´ì•ˆì´ë‚˜ ì„±ëŠ¥ ê²©ë¦¬ê°€ ê·¹ë„ë¡œ ì¤‘ìš”í•œ ê²½ìš°, ê° ë„¤ì„ìŠ¤í˜ì´ìŠ¤ë§ˆë‹¤ ë…ë¦½ì ì¸ ì»¨íŠ¸ë¡¤ëŸ¬ ì—”ì§„ì„ ì„¤ì¹˜í•˜ëŠ” ë°©ì‹ì…ë‹ˆë‹¤.

#### 1. ë„¤ì„ìŠ¤í˜ì´ìŠ¤ë³„ ì„¤ì • íŒŒì¼ ì‘ì„± (Helm Values)

* **íŒŒì¼ëª…**: `values-prod.yaml` (ìš´ì˜ìš©)

```yaml
controller:
  ingressClassResource:
    name: prod-nginx
  scope:
    enabled: true
    namespace: "megaprod"
  replicaCount: 2

```

* **íŒŒì¼ëª…**: `values-dev.yaml` (ê°œë°œìš©)

```yaml
controller:
  ingressClassResource:
    name: dev-nginx
  scope:
    enabled: true
    namespace: "megadev"
  replicaCount: 1
  admissionWebhooks:
    enabled: false

```

#### 2. ì‹¤í–‰ ë° ì„¤ì¹˜ ë°©ë²• (Helm)

```bash
# ìš´ì˜ í™˜ê²½ ì „ìš© ì»¨íŠ¸ë¡¤ëŸ¬ ì„¤ì¹˜
helm install prod-ingress ingress-nginx/ingress-nginx -f values-prod.yaml --namespace megaprod

# ê°œë°œ í™˜ê²½ ì „ìš© ì»¨íŠ¸ë¡¤ëŸ¬ ì„¤ì¹˜
helm install dev-ingress ingress-nginx/ingress-nginx -f values-dev.yaml --namespace megadev

```

---

### 3. êµ¬ì„± ê²°ê³¼ ê²€ì¦

```bash
# ì„¤ì¹˜ëœ ì¸ê·¸ë ˆìŠ¤ í´ë˜ìŠ¤ ëª©ë¡ í™•ì¸
kubectl get ingressclass

# ë„¤ì„ìŠ¤í˜ì´ìŠ¤ë³„ ì»¨íŠ¸ë¡¤ëŸ¬ ì‹¤í–‰ ìƒíƒœ í™•ì¸
kubectl get pods -n megaprod
kubectl get pods -n megadev

```

---

### ğŸ’¡ ì‹¤ì „ ì „ë¬¸ íŒ (Expert Tips)

* **ë¹„ìš© ìµœì í™”**: AWS í™˜ê²½ì—ì„œ Case 2 ë°©ì‹ì€ ë¡œë“œë°¸ëŸ°ì„œê°€ ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ê°œìˆ˜ë§Œí¼ ìƒì„±ë˜ì–´ **ì¶”ê°€ ê³¼ê¸ˆ(LB ìƒì„± ë¹„ìš©)**ì´ ë°œìƒí•©ë‹ˆë‹¤. í•™ìŠµìš©ìœ¼ë¡œëŠ” Case 1(ê³µìœ í˜•)ì„ ê¶Œì¥í•©ë‹ˆë‹¤.
* **ìœ ë£Œ ì„œë¹„ìŠ¤ ì£¼ì˜**: `LoadBalancer` íƒ€ì… ì„œë¹„ìŠ¤ëŠ” ì™¸ë¶€ IP í• ë‹¹ì„ ìœ„í•´ ìƒì„± ì¦‰ì‹œ ë¹„ìš©ì´ ë°œìƒí•˜ë¯€ë¡œ ì‹¤ìŠµ í›„ ë°˜ë“œì‹œ `helm uninstall`ë¡œ ë¦¬ì†ŒìŠ¤ë¥¼ ì‚­ì œí•˜ì‹­ì‹œì˜¤.
* **í˜¸ìŠ¤íŠ¸ íŒŒì¼ ì„¤ì •**: ì‹¤ì œ ë„ë©”ì¸ì´ ì—†ëŠ” ì‹¤ìŠµ í™˜ê²½ì—ì„œëŠ” ë¡œì»¬ PCì˜ `/etc/hosts` íŒŒì¼ì— ë¡œë“œë°¸ëŸ°ì„œ IPì™€ `prod.mega-it.com` ë“±ì˜ í˜¸ìŠ¤íŠ¸ëª…ì„ ë§¤í•‘í•˜ì—¬ í…ŒìŠ¤íŠ¸í•˜ì‹­ì‹œì˜¤.

---

**Next Step: Ingress TLS(HTTPS) ë³´ì•ˆ ì„¤ì • ë° ì¸ì¦ì„œ ì ìš©**

êµì¬ êµ¬ì„±ì— í•„ìš”í•œ íŒŒì¼ëª…ê³¼ ì‹¤í–‰ ëª…ë ¹ì–´ë¥¼ ë³´ê°•í•˜ì˜€ìŠµë‹ˆë‹¤. ë‹¤ìŒ ë‹¨ê³„ë¡œ ë„˜ì–´ê°€ì‹œê² ìŠµë‹ˆê¹Œ?
