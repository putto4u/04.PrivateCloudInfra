## 네임스페이스 관리 및 컨텍스트 전환 최적화

쿠버네티스 클러스터 운영 시 작업 대상 네임스페이스를 명시적으로 지정하지 않으면 기본적으로 `default` 네임스페이스를 참조합니다. 빈번한 `-n [Namespace]` 옵션 사용을 줄이고 관리 효율을 높이기 위한 설정 방법입니다.

---
### 1. 실습용 네임스페이스 생성

운영 환경과 개발 환경을 분리하기 위해 두 개의 네임스페이스를 생성합니다.

```bash
kubectl create namespace wb_prod
kubectl create namespace wb_dev


# kkubectl taint node k8master01 node.kubernetes.io/disk-pressure:NoSchedule-   ## 실습용 마스터에서 테스트 허용

```

---

### 2. 기본 네임스페이스(Default) 설정

현재 사용 중인 컨텍스트의 기본 네임스페이스를 특정 네임스페이스로 고정하면 이후 모든 명령어에서 `-n` 옵션을 생략할 수 있습니다.

**현재 컨텍스트를 wb_prod로 설정**

```bash
kubectl config set-context --current --namespace=wb_prod

```

**설정 상태 확인**

```bash
kubectl config view --minify | grep namespace:

```

* 출력 결과에 `namespace: wb_prod`가 포함되어 있으면 해당 컨텍스트에서 실행되는 모든 명령은 자동으로 `wb_prod`에 적용됩니다.

---

### 3. 컨텍스트 전환 및 네임스페이스 변경

환경 변경이 필요할 경우 아래 명령어를 통해 기본 네임스페이스를 전환합니다.

```bash
# 개발 환경(wb_dev)으로 전환
kubectl config set-context --current --namespace=wb_dev

# 운영 환경(wb_prod)으로 복구
kubectl config set-context --current --namespace=wb_prod

```

---

### 4. 생산성 향상을 위한 유틸리티 활용 (kubens)

명령어 기반의 전환 방식보다 직관적이고 빠른 네임스페이스 전환을 위해 전용 도구 사용을 권장합니다.

* **설치 (macOS):** `brew install kubectx`
* **주요 사용법**
* `kubens`: 현재 클러스터에 존재하는 모든 네임스페이스 목록 출력
* `kubens [Name]`: 지정한 네임스페이스로 즉시 전환
* `kubens -`: 바로 이전에 사용했던 네임스페이스로 복귀



**Alias(별칭) 설정 예시**
유틸리티 설치가 제한적인 환경에서는 쉘 설정 파일(`~/.bashrc` 또는 `~/.zshrc`)에 별칭을 등록하여 사용합니다.

```bash
alias kcp='kubectl config set-context --current --namespace=wb_prod'
alias kcd='kubectl config set-context --current --namespace=wb_dev'

```

---

### 5. 운영 시 주의사항

* **대상 환경 확인**: 특정 네임스페이스를 기본값으로 설정하면 삭제(`delete`)나 수정 명령 시 엉뚱한 환경에 적용될 위험이 있습니다.
* **프롬프트 시각화**: 현재 접속 중인 네임스페이스 정보를 터미널 프롬프트에 표시해주는 `kube-ps1` 등의 도구를 병행 사용하면 실수를 방지할 수 있습니다.
* **비용**: 네임스페이스의 생성 및 전환은 쿠버네티스 클러스터 내부의 논리적 설정 변경이므로 **추가적인 인프라 비용이 발생하지 않습니다.**

---

Next Step: **kube-ps1을 이용한 터미널 프롬프트 시각화 설정**

---

개인별 맞춤 설정에 따라 교재 본문에는 요청하신 기술적 내용만 구성했습니다. 나에게 하는 말은 이 구분선 아래에 배치했습니다. 깃허브에 바로 커밋할 수 있는 마크다운 포맷입니다. 수정이 필요한 부분이 있다면 말씀해 주세요.
