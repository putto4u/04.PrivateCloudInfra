VirtualBox와 같은 가상 환경에서 디스크 용량을 50GB로 할당했음에도 불구하고, 실제 OS 내부(`df -h`)에서 루트(`/`) 파티션이 25GB(절반) 정도만 인식되는 현상은 매우 흔한 케이스입니다.

이는 주로 **Ubuntu 설치 시 'LVM(Logical Volume Manager)' 설정이 기본값으로 전체 디스크의 50%만 할당하도록 되어 있기 때문**입니다. 나머지 25GB는 사용되지 않는 'Free PE(Physical Extents)' 상태로 LVM 볼륨 그룹 안에 잠겨 있는 것입니다.

재설치 없이 명령어로 즉시 나머지 용량을 확장하는 방법을 단계별로 안내해 드립니다.

---

## 1. 현재 상태 확인

먼저 어떤 논리 볼륨(LV)을 확장해야 하는지 확인합니다.

```bash
df -h

```

출력 내용 중 `/dev/mapper/ubuntu--vg-ubuntu--lv` (이름은 약간 다를 수 있음)가 루트(`/`)에 마운트되어 있고, 용량이 예상보다 적은지 확인하세요.

그 다음, 볼륨 그룹에 남은 여유 공간이 있는지 확인합니다.

```bash
sudo vgs

```

`VFree` 항목에 남은 용량(약 25G 등)이 표시된다면 아래 과정을 진행하면 됩니다.

---

## 2. 논리 볼륨(LV) 확장

볼륨 그룹의 남은 모든 공간을 해당 논리 볼륨에 할당합니다.

```bash
sudo lvextend -l +100%FREE /dev/mapper/ubuntu--vg-ubuntu--lv

```

> **Tip:** `/dev/mapper/...` 경로는 위 `df -h`에서 확인한 본인의 루트 파일 시스템 경로를 입력하세요.

---

## 3. 파일 시스템 사이즈 재조정 (Resize)

볼륨의 크기는 커졌지만, 실제 파일 시스템이 이를 인식하도록 리사이징해야 합니다. (Ubuntu 기본인 ext4 기준)

```bash
sudo resize2fs /dev/mapper/ubuntu--vg-ubuntu--lv

```

*만약 파일 시스템이 XFS라면 `sudo xfs_growfs /` 명령어를 사용해야 합니다.*

---

## 4. 최종 결과 확인

이제 다시 용량을 확인해 보면 50GB 전체가 반영된 것을 볼 수 있습니다.

```bash
df -h

```

---

### 💡 실전 팁: 왜 이런 일이 발생하나요?

Ubuntu 서버 설치 프로그램(Subiquity)은 LVM을 사용할 때 만약의 상황(스냅샷, 다른 파티션 추가 등)을 대비해 **전체 용량의 절반만 할당하는 것을 기본값**으로 제안합니다.

가상 머신(VM) 운영 중 디스크 용량이 부족할 때, 설정을 통해 물리적인 디스크 크기를 키우고 이를 OS 내부 파티션에 반영하는 과정을 단계별로 정리해 드립니다.

이 작업은 크게 **1) 가상 머신 설정(S/W)에서 디스크 확장**, **2) 게스트 OS(Linux) 내부에서 파티션 확장** 두 단계로 나뉩니다.

---

## 1. VirtualBox 설정에서 디스크 용량 늘리기

먼저 가상 머신이 **종료된 상태**여야 합니다.

1. VirtualBox 관리자 화면 상단 메뉴에서 **[파일] -> [가상 미디어 관리자]**를 클릭합니다.
2. 목록에서 해당 가상 머신의 가상 디스크(`.vdi` 또는 `.vmdk`)를 선택합니다.
3. 하단의 **[크기]** 슬라이더를 조절하거나 숫자를 직접 입력하여 원하는 용량(예: 100.00 GB)으로 변경한 후 **[적용]**을 누릅니다.
4. 가상 머신 **[설정] -> [저장소]**에서 해당 디스크의 정보가 변경된 용량으로 표시되는지 확인합니다.

---

## 2. 게스트 OS(Ubuntu) 파티션 확장

디스크의 물리적 크기만 늘어난 상태이므로, OS 내부에서 이 '할당되지 않은 공간'을 실제 파티션에 합쳐줘야 합니다.

### 방법 A: GUI 도구(GParted) 사용 (추천)

가장 시각적이고 안전한 방법입니다.

1. 터미널에서 `sudo apt install gparted -y && sudo gparted`를 실행합니다.
2. 오른쪽 끝에 회색으로 된 **[unallocated]** 공간이 보입니다.
3. 확장하고자 하는 파티션(보정 `/dev/sda3` 또는 `lvm` 등)을 오른쪽 클릭하고 **[Resize/Move]**를 선택합니다.
4. 화살표를 끝까지 드래그하여 여유 공간을 모두 포함시킨 후 **[Resize]**를 누릅니다.
5. 상단 체크 아이콘(**[Apply All Operations]**)을 클릭하여 확정합니다.

### 방법 B: CLI 명령어로 확장 (LVM 환경)

지난번처럼 LVM을 사용 중이라면 명령어로 간단히 가능합니다.

1. **물리 볼륨(PV) 확장:** 늘어난 디스크 크기를 LVM이 인식하게 합니다.
```bash
sudo pvresize /dev/sda3  # 본인의 물리 파티션 번호 확인 필요

```


2. **논리 볼륨(LV) 확장:** 볼륨 그룹의 남은 공간을 루트 볼륨에 할당합니다.
```bash
sudo lvextend -l +100%FREE /dev/mapper/ubuntu--vg-ubuntu--lv

```


3. **파일 시스템 리사이징:**
```bash
sudo resize2fs /dev/mapper/ubuntu--vg-ubuntu--lv

```



---

### ⚠️ 주의사항 및 실전 팁

* **백업 필수:** 파티션을 건드리는 작업이므로 중요 데이터가 있다면 가상 머신 복제(Clone)나 스냅샷을 먼저 생성하세요.
* **유료 서비스 안내:** VirtualBox 자체는 오픈소스이나, 클라우드 환경(AWS EBS 등)에서 이와 같이 디스크 용량을 추가할 경우 **추가된 용량만큼 기가바이트(GB)당 월간 비용이 즉시 발생**하므로 주의가 필요합니다.
* **고정 크기 vs 동적 할당:** 디스크 생성 시 '고정 크기'로 만들었다면 확장 시간이 오래 걸릴 수 있습니다.

---

**Next Step: 파티션 복구 및 데이터 손실 방지를 위한 스냅샷 관리**

* 특정 단계에서 에러가 발생하거나 파티션 구조가 복잡해 보인다면 `lsblk` 명령어 결과를 알려주세요. 맞춤형 명령어를 다시 구성해 드리겠습니다.
