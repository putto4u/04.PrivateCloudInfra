우분투 환경에서 도커의 핵심 사이클을 익힐 수 있는 실습 과정입니다. 이 내용은 이미지를 생성하고 배포하며, 외부와 통신하는 전체 과정을 포함하고 있습니다.

---

### 1. 도커 이미지 생성 및 빌드

먼저 간단한 웹 서버 역할을 할 `index.html`과 이를 이미지로 만들 `Dockerfile`을 작성합니다.

```bash
# 1. 실습 디렉토리 생성 및 이동
mkdir ~/docker-practice && cd ~/docker-practice

# 2. 테스트용 HTML 파일 작성
echo "<h1>Hello from Docker!</h1>" > index.html

# 3. Dockerfile 작성
# Nginx를 베이스 이미지로 사용하여 html 파일을 복사하는 설정
cat <<EOF > Dockerfile
FROM nginx:latest
COPY index.html /usr/share/nginx/html/index.html
EOF

# 4. 이미지 빌드 (-t는 태그/이름 설정)
docker build -t my-web-app:v1 .

```

### 2. 이미지 확인 및 상태 해설

생성된 이미지를 확인하고 출력되는 정보의 의미를 파악합니다.

```bash
# 1. 이미지 목록 보기
docker images

```

* **REPOSITORY**: 이미지의 이름 (예: `my-web-app`)
* **TAG**: 이미지의 버전 (예: `v1`). 지정하지 않으면 `latest`가 기본값입니다.
* **IMAGE ID**: 이미지의 고유 식별자 (해시값).
* **CREATED**: 이미지가 생성된 시점.
* **SIZE**: 이미지가 차지하는 용량.

### 3. 포트 포워딩을 이용한 컨테이너 실행

컨테이너의 포트를 호스트(우분투)의 포트와 연결하여 외부 접속을 허용합니다.

```bash
# -d: 백그라운드 실행, -p [호스트포트]:[컨테이너포트]
docker run -d -p 8080:80 --name web-container my-web-app:v1

```

### 4. 접속 확인 (Curl 및 브라우저)

서비스가 정상적으로 구동되는지 내부와 외부에서 확인합니다.

* **터미널에서 확인**:
```bash
curl localhost:8080

```


* **브라우저에서 확인**: 주소창에 `http://[우분투_IP]:8080` 입력

### 5. 이름 바꾸기 (Tag 변경)

도커 허브에 올리기 위해서는 `사용자ID/이미지명` 형식을 갖춰야 합니다. `tag` 명령어로 이름을 바꿀 수 있습니다.

```bash
# docker tag [기존이미지:태그] [새이름:태그]
docker tag my-web-app:v1 [본인_도커허브_ID]/my-web-app:v1

# 바뀐 이름 확인
docker images | grep my-web-app

```

### 6. 도커 허브 업로드 (Push) 및 다운로드 (Pull)

빌드한 이미지를 원격 저장소에 저장하고 다시 내려받습니다.

```bash
# 1. 도커 허브 로그인 (발급받은 토큰 사용)
docker login -u [도커허브_ID]

# 2. 이미지 업로드
docker push [본인_도커허브_ID]/my-web-app:v1

# 3. 로컬 이미지 삭제 (테스트를 위해)
docker rmi [본인_도커허브_ID]/my-web-app:v1

# 4. 도커 허브에서 이미지 다운로드
docker pull [본인_도커허브_ID]/my-web-app:v1

```

### 7. 바꾼 이름으로 다시 실행해보기

다운로드한 이미지를 사용하여 새로운 포트로 실행합니다.

```bash
# 8081 포트로 새로운 이름의 이미지를 실행
docker run -d -p 8081:80 --name web-v2 [본인_도커허브_ID]/my-web-app:v1

# 실행 상태 확인 (STATUS 열 해설)
docker ps

```

* **Up (시간)**: 컨테이너가 가동 중인 시간.
* **Exited (코드)**: 컨테이너가 종료됨을 의미.
* **Restarting**: 컨테이너가 재시작 시도 중임.

---

> [!IMPORTANT]
> **AWS 과금 및 보안 주의**: 포트 포워딩한 **8080, 8081** 포트에 브라우저로 접속하려면, AWS 웹 콘솔의 **보안 그룹(Security Group)** 설정에서 해당 포트들에 대한 인바운드 규칙을 허용해야 합니다. 실습 후 사용하지 않는 이미지는 `docker rmi`로 삭제하여 EBS 스토리지 비용을 관리하세요.

Next Step: **Docker 볼륨 마운트를 통한 데이터 영구 보존 실습**
