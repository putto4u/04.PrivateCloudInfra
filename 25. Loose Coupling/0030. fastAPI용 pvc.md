## FastAPI 영구 저장소 구축을 위한 독립 PVC 정의

애플리케이션의 실행 로직(FastAPI)과 데이터 저장소(PVC)를 분리하여 관리하는 **느슨한 결합(Loose Coupling)** 원칙에 따라, 백엔드 전용 영구 저장소 자원을 단독으로 생성합니다.

---

### 1. 백엔드 전용 영구 볼륨 클레임 정의 (`back-pvc.yaml`)

이 파일은 실제 서버(FastAPI)가 배포되기 전에 클러스터로부터 2GiB의 저장 공간을 미리 확보하는 역할을 합니다. 애플리케이션의 설정과 무관하게 독립적인 생명주기를 가집니다.

```yaml
# back-pvc.yaml
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: back-pvc
  namespace: wb_prod
spec:
  accessModes:
    - ReadWriteOnce
  storageClassName: local-path  # 설치된 Local Path Provisioner 활용
  resources:
    requests:
      storage: 2Gi              # 백엔드 데이터 저장용 2GB 요청

```

---

### 2. 느슨한 결합의 구조적 특징

* **독립적 생명주기**: FastAPI 포드를 삭제하거나 업데이트하더라도 `back-pvc`는 삭제되지 않고 데이터를 유지합니다.
* **이름 기반 연결**: 나중에 작성할 FastAPI 배포 파일(Deployment)은 실제 스토리지의 위치를 알 필요 없이 오직 `name: back-pvc`라는 식별자만으로 이 자원을 호출합니다.
* **유연한 교체**: 추후 로컬 디스크가 아닌 클라우드 관리형 스토리지(EBS 등)로 변경하더라도, 애플리케이션 코드는 수정하지 않고 이 PVC 설정만 변경하여 대응할 수 있습니다.

---

### 3. 설치 및 상태 확인

**단계 1: PVC 생성**

```bash
kubectl apply -f back-pvc.yaml

```

**단계 2: 바인딩 상태 확인**
`STATUS` 항목이 `Bound`로 표시되면 성공적으로 저장 공간이 할당된 것입니다. (단, Local Path의 특성상 실제 사용 포드가 생성될 때까지 `Pending` 상태를 유지할 수도 있습니다.)

```bash
kubectl get pvc back-pvc -n wb_prod

```

---

### 4. 주요 관리 포인트

* **네임스페이스 일치**: 이 PVC를 호출할 FastAPI 서버와 반드시 동일한 네임스페이스(`wb_prod`)에 존재해야 합니다.
* **로컬 스토리지의 한계**: `local-path`를 사용하므로 데이터는 특정 워커 노드에 귀속됩니다. 포드 재시작 시 쿠버네티스가 해당 데이터가 있는 노드로 포드를 자동 배치합니다.

> [!IMPORTANT]
> **과금 관련 안내**:
> 본 설정은 클라우드 유료 스토리지 서비스가 아닌 인스턴스 로컬 디스크를 점유하므로 **추가적인 과금이 발생하지 않습니다.** 단, 요청한 2GiB의 용량은 인스턴스의 전체 디스크 가용량에 포함됨을 유의하십시오.

---

Next Step: **FastAPI Deployment에서 back-pvc를 호출하는 볼륨 연결 설정**

---
