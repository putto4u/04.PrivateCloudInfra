## 프로젝트 종합 평가 및 가이드: IaC 기반 고가용성 DB 클러스터 아키텍처

본 프로젝트는 쿠버네티스 환경에서 **느슨한 결합(Loose Coupling)** 원칙을 실무 수준으로 구현하여, 데이터의 영속성이 보장되는 MySQL 클러스터와 이를 활용하는 백엔드 애플리케이션을 구축하는 전 과정을 다룹니다.

---

### 1. 프로젝트 전체 구조 (Architecture)

전체 시스템은 **접속층(Ingress/Service)**, **연산층(Pod/Deployment)**, **저장층(PV/PVC)**의 3단계 계층 구조로 설계되었습니다.

* **Ingress**: 단일 고정 IP(`192.168.0.251`)를 통해 경로 기반 라우팅 수행 (`/`, `/vew`, `/bucket`)
* **MySQL Cluster**: 쓰기 전용(Primary) 1대와 읽기 전용(Replica) 2대로 구성된 Master-Slave 아키텍처
* **Storage**: 로컬 패스 프로비저너를 사용하여 노드 내 독립된 물리 디렉토리에 데이터 저장

---

### 2. 추천 프로젝트 디렉토리 구조

실무에서는 리소스별로 파일을 분리하여 관리하는 것이 유지보수에 유리합니다. 깃허브(GitHub)에 업로드하기 최적화된 구조입니다.

```text
k8s-project/
├── network/
│   └── ingress.yaml          # 인그레스 설정 (192.168.0.251)
├── storage/
│   └── mysql-pvc.yaml        # DB용 로컬 패스 PVC (3개)
├── database/
│   ├── mysql-deploy.yaml     # MySQL Primary & Replica 배포
│   └── mysql-service.yaml    # mysql-write, mysql-read 서비스
├── apps/
│   ├── py-web-deploy.yaml    # Python 기본 웹 (읽기 전용 연결)
│   └── fastapi-deploy.yaml   # FastAPI 백엔드 (읽기/쓰기 분리 연결)
└── README.md                 # 프로젝트 개요 및 실행 방법

```

---

### 3. 프로젝트 진행 절차 (Step-by-Step)

1. **네트워크 및 저장소 준비**: 인그레스 컨트롤러와 Local Path Provisioner가 정상 작동하는지 확인합니다.
2. **영구 저장소(PVC) 생성**: DB 데이터가 저장될 3개의 독립된 그릇을 먼저 만듭니다.
3. **DB 엔진 배포**: Primary와 Replica 포드를 띄우고 PVC와 연결합니다.
4. **DB 서비스(LB) 구축**: 쓰기용 서비스와 읽기용 로드밸런서 서비스를 생성합니다.
5. **데이터 복원**: `employees.sql` 샘플 데이터를 Primary에 복구하고 Replica로 복제(Replication) 설정을 진행합니다.
6. **애플리케이션 연동**: Python과 FastAPI 앱을 배포하여 DB 서비스 이름으로 연결합니다.

---

### 4. 브라우저 및 최종 확인 방법

구축이 완료되면 브라우저에서 경로별로 접속하여 인프라의 정상 작동 여부를 테스트합니다.

| 접속 경로 | 확인 대상 | 예상 결과 |
| --- | --- | --- |
| `http://192.168.0.251/` | **Nginx** | 기본 인덱스 페이지 또는 설정한 메인 화면 출력 |
| `http://192.168.0.251/vew` | **Python App** | DB(mysql-read)에서 가져온 부서 목록 리스트 출력 |
| `http://192.168.0.251/bucket` | **FastAPI** | API 상태 메시지 JSON 출력 |
| `http://192.168.0.251/bucket/depts` | **DB 연동** | Primary에 입력한 데이터가 Replica를 통해 조회되는지 확인 |

---

### 5. 전문가 총평 및 프로젝트 가치 (Project Evaluation)

본 프로젝트는 단순한 서비스 배포를 넘어 **인프라 아키텍처의 유연성과 안정성**을 확보하는 데 집중하고 있습니다.

* **아키텍처의 성숙도 (High)**: `hostPath`의 한계를 극복하기 위해 로컬 패스 프로비저너를 도입하고, 서비스 이름 중심의 DNS 통신을 구현한 점은 현업의 클라우드 네이티브 방식과 일치합니다.
* **운영의 유연성 (Excellent)**: 레이블(Label)과 셀렉터(Selector)의 논리적 결합을 통해, 기존 설정을 파괴하지 않고도 Primary 서버를 읽기 로드밸런싱 그룹에 참여시키는 등 고도의 운영 기법이 적용되었습니다.
* **상태 유지 능력 (Stable)**: DB의 복제(Replication) 설정과 PVC의 분리 구축을 통해 하드웨어 장애 상황에서도 데이터 손실을 최소화할 수 있는 복구력을 갖추었습니다.
* **확장 가능성 (Scalable)**: 백엔드 서버와 DB 레플리카 서버를 `replicas` 값 조절만으로 언제든 수평 확장(Scale-out)할 수 있는 무상태(Stateless) 앱 설계가 잘 반영되었습니다.

---

### 6. 프로젝트 평가 항목 (Self-Checklist)

* [ ] **영속성**: DB 포드를 삭제 후 재생성해도 데이터가 그대로 유지되는가?
* [ ] **부하 분산**: `mysql-read` 호출 시 Primary를 포함한 3대의 서버가 골고루 응답하는가?
* [ ] **느슨한 결합**: 소스 코드에 IP 주소 대신 서비스 이름(`mysql-write` 등)을 사용했는가?
* [ ] **복제**: Primary에서 생성한 데이터가 Replica 서버들로 실시간 동기화되는가?
* [ ] **가용성**: 특정 레플리카 포드가 장애가 나도 서비스 중단 없이 운영되는가?

> [!IMPORTANT]
> **최종 과금 안내**:
> 본 프로젝트는 클라우드 관리형 서비스(RDS, ELB)를 사용하지 않고 쿠버네티스 내부 자원만 활용하므로 **추가적인 서비스 과금은 발생하지 않습니다.** (단, EC2 인스턴스 유지 비용 제외)

---

Next Step: **back-pvc**
